<!doctype html>
<html lang="Es"><!--Idioma Español-->
    <head>
        <meta charset="utf-8">
        <meta name="Descripción" content="Sargazo LANOT"> <!--Nos genera una descripción de la pagina-->
        <title>Visulizador de Sargazo LANOT</title> <!--Titulo de la pestaña en buscador-->
        <!--meta name="viewport" content="width=device-width, user-scalable=no"--> <!--Ajusta la pagina a la pantalla-->
        <meta name="Keywords" content="Incendios, LANOT, LAGE, México"> <!--Palabras clave-->
        <link rel="styleSheet" href="static/css/Escritorio.css">
        <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"><!-- Adapta el ancho del navegador con el ancho del dispositivo-->
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
            integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
        <link rel="stylesheet" href="static/css/ol.css">
        <script src="https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@master/en/v6.2.1/build/ol.js" ></script><!--Javascript de OpenLayers-->
        <script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
        <script src="http://code.jquery.com/ui/1.9.2/jquery-ui.js"></script>		
        <link rel="stylesheet" href="static/css/ol-ext.css">  <!--ol-ext-->
        <script src="static/js/ol-ext.js" type="text/javascript"></script><!--Javascript de ol-ext -->
        <script src="http://code.jquery.com/jquery-latest.js"></script><!--Javascript de jquery-->
        <script src="static/js/menu.js" type="text/javascript"></script>
        <script src="static/js/under.js" type="text/javascript"></script>
        <script src="static/js/Buscar_pc.js" type="text/javascript"></script><!--Relacionado con la consulta de puntos-->
        <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
        <script src="static/js/infolayer.js" type="text/javascript"></script><!--Información de puntos de calor-->
        <script src="static/js/botones.js" type="text/javascript"></script>
        <script src="static/js/slideimg.js"></script><!--Altura de simbología-->
        <!-- Geocoder -->
        <link rel="stylesheet" href="static/js/ol-geocoder/ol-geocoder.css">
        <script src="static/js/ol-geocoder/ol-geocoder.js" type="text/javascript"></script>
        <script src="static/js/ol-geocoder/nominatim.js"></script>
        <script src="static/js/ol-geocoder-debug.js" type="text/javascript"></script>
        <!-- <script src="S2_MSI_SAR_20210531T160901.json"></script> -->
        <!-- Sweetalert -->
        <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
        
    </head>
    <body>
        <div id="preloader"></div>
        <header>	
            <div class="menu_bar">
                <a><img src="static/img/32px/190-menu.png" class="menu"></a>
                <a id=Sar>Visualizador de Sargazo LANOT</a>
            </div>	
                  
            <nav>
                <ul class="menu_mapcont">
                    <li><a href="#" class="info"><img src="static/img/16px/269-info.png">Tutoriales</a></li>
                    <li><a href="#" class="infoimage"><img src="static/img/16px/015-images.png">Descarga de imágenes Sentinel</a></li>
                </ul>
                
            </nav>
            
        <!--div id="principal contenedor limpiar"-->
            
			<div id="menu">
				 
				<!--form action ="" method="post"-->
                    <div class="con">
                        
                            <h1> Ingrese las fechas correspondientes para realizar su consulta </h1>    			
                            <div class="busqueda" id="busqueda">      
                            <label id="label" for=""> Inicio:</label>
                            <br><input type="date" name="date3"  id="date3" min= "2019-05-01" required>

                            <br><label id="label" for=""> Termino:</label>
                            <br><input type="date" name="date4" id="date4" required>

                            <br><br>
                            <div align="center"><input type="submit" value="Buscar" class="botton-Buscar" id="Buscar"/></div>    
                            </div>
                    </div>
                    <div class="Descarga"> 
                        <h1 href="#" class="descarga">Formatos de descarga:</h1>
                        <div class="Formatos">
                            <div align="center"><input  type="button" class="botton-Json" value="GeoJson" >
                            <input type="button" class="botton-CSV" value="CSV">
                            <input  type="button" class="botton-Shape" value="Shapefile" ></div>
                        </div>
                    </div>
                    <div class="Capas">
                        <div class="Vecotoriales">
                            <h1>Vectoriales</h1>
                            <input type="checkbox" id="sargazo" value="1" checked=""/>
                            <label for="check1">Sargazo 31/05/2021</label><br>
                            <input type="checkbox" id="estados" value="1" checked=""/>
                            <label for="check1">Estados</label><br>
                        </div>
                        <div class="Raster">
                            <h1>Imágenes</h1>
                            <input type="checkbox" id="goes" value="1"/>
                            <label for="check1">Sentinel TC</label><br>
                        </div>
                        <div class="BaseMap">
                            <h1>Mapas Base</h1>
                            <div align="center">
                            <label id="mapbase">
                                
                                <img src="./static/img/satelite.png" width="60px" height="60px" id="satelital"><br>                                
                                <p>Satélite</p>
                            </label>
                            <label id="mapbase">
                                
                                <img src="./static/img/OSM.png" width="60px" height="60px" id="osm"><br>                                
                                <p text-align="center">OSM</p>
                            </label>
                            <label id="mapbase">
                                <!-- <input type="checkbox" id="oscuro" value="1"  /> -->
                                <img src="./static/img/oscuro.png" width="60px" height="60px" id="oscuro"><br>                                
                                <p>Oscuro</p>
                            </label>
                            </div>
                        </div>
                    </div>
             
                                
			</div>
        </header>
    <div id="body-grapper"></div>     
    <section>
          
    <div id="map" class="map"></div>        
    <br>
    <abbr title="Capas">    
        <div id="fig"><img src="static/img/32px/layer.png"></div>
    </abbr>
    <abbr title="Da clic si quieres saber la información de los puntos de calor de las últimas 24 horas">
        <label id="fig1">
            <input type="checkbox" class="puntosinfo" value="0" checked="" />
            <img src="static/img/32px/Informacion.png">                                
        </label> 
    </abbr>
   
    <div id="infopuntos"></div>
    
    
    <abbr title="Consultas de puntos de calor">
        <div id="fecha"><img src="static/img/32px/calendar.png"></div>
    </abbr>
    <abbr title="Descarga los puntos de calor">
        <div id="download"><img src="static/img/32px/download.png"></div>
    </abbr>
    <div class="Simbologia">
        <h5>Simbología</h5>
        <div id="imagen" align="center">
            <img src="static/img/Simbo/PuntosActuales.png" class="imgpa"/>
            <img src="static/img/Simbo/estados.png" class="imgest"/>
            
        </div>
    </div>
			                
        <script>
                //variables fechas
                var fecha_1 = '0000-00-00';
                var fecha_2 = '0000-00-00';
                
                //Agregamos variables de los horarios de las ultimas imagenes
                var fecha = '{{ fechabi }}';
                var hora = '{{ horabi }}';
                function fechabi(){ 
                    swal("La fecha de la imagen es: "+fecha+ "y la hora: "+hora);
                }
                                                  
				// Layer de Puntos actuales
                // var vector = new ol.layer.Vector({
                //     source: new ol.source.Vector({
                //         projection: 'EPSG:3857',
                //         url: "sargazo.json",
                //         format: new ol.format.GeoJSON()
                //     })
                // })


                // map.addLayer(vector);   
                
            	//Creamos objeto mapa		
				var map = new ol.Map({//Abrimos mapa
                    layers: [
                        new ol.layer.Tile({
                            source: new ol.source.TileImage({
                            visible: true,
                            url: 'https://mt1.google.com/vt/lyrs=y&x={x}&y={y}&z={z}'
                            }),
                            type: 'base',
                            visible: true,
                            zIndex: 0 
                        }),
                        new ol.layer.Vector({
                        source: new ol.source.Vector({
                            projection: 'EPSG:32616',
                            url: "sargazo.json",
                            format: new ol.format.GeoJSON()
                            })
                        })
                    ],
                    target: 'map',//target map
				    view: new ol.View({//Creamos vista del mapa
                        center: ol.proj.transform([-86, 20], 'EPSG:4326', 'EPSG:3857'),//Cambiamos proyección a WGS84
                        zoom: 7
                	})//Cerramos view
                });//Cerramos mapa
		
				//Creamos Barra de Escala
				var scaleline = new ol.control.ScaleLine();
										
				
				//Creamos objeto posición del mouse	
				var mousePositionControl = new ol.control.MousePosition({
					className: 'custom-mouse-position',
					projection: 'EPSG:4326',
					target: document.getElementById('location'),
					coordinateFormat: ol.coordinate.createStringXY(5),
					undefinedHTML: '&nbsp;'
				});//Cerramos objeto posición del mouse						
                      

                

                //Layer Estados de la república 
                var wmsSourceestados = new ol.source.TileWMS({
                    visible: true,
                    url: 'http://132.247.103.145:8080/geoserver/DGRU_LANOT/wms',
                    params: {'LAYERS':'DGRU_LANOT:coastline_mexicoMerc','TILED': true},
                    serverType: 'geoserver',
                    });

                var wmsLayerestados = new  ol.layer.Tile({
                    source: wmsSourceestados,
                    zIndex: 1
                });
                map.addLayer(wmsLayerestados);
                $('#estados').click(function(){
                    var imgest =  "static/img/Simbo/estados.png";
                    if($(this).is(':checked')){
                        map.addLayer(wmsLayerestados);
                        $('#imagen').append('<img src="'+imgest+'" class="imgest"/>');
                    } else {
                        map.removeLayer(wmsLayerestados);
                        $('img').remove('.imgest');
                    }
                });

                //Layer Sargazo
                var wmsSourcesargazo = new ol.source.TileWMS({
                    visible: true,
                    url: 'http://132.247.103.145:8080/geoserver//wms',
                    params: {'LAYERS':'LANOT:sargazo','TILED': true},
                    serverType: 'geoserver',
                    });

                var wmsLayersargazo = new  ol.layer.Tile({
                    source: wmsSourcesargazo,
                    zIndex: 1
                });
                map.addLayer(wmsLayersargazo);
                $('#sargazo').click(function(){
                    var imgest =  "static/img/Simbo/estados.png";
                    if($(this).is(':checked')){
                        map.addLayer(wmsLayersargazo);
                        $('#imagen').append('<img src="'+imgsarg+'" class="imgest"/>');
                    } else {
                        map.removeLayer(wmsLayersargazo);
                        $('img').remove('.imgsarg');
                    }
                });
                //Layer Áreas Naturales Protegidas
                var wmsSourceANP = new ol.source.TileWMS({
                    visible: true,
                    url: 'http://132.247.103.145:8080/geoserver/fires/wms',
                    params: {'LAYERS':'fires:ANP2020','TILED': true},
                    serverType: 'geoserver',
                    });

                var wmsLayerANP = new  ol.layer.Tile({
                    source: wmsSourceANP,
                    zIndex: 1,
                    transparent: 'true'
                });

                $('#anp').click(function(){
                    var imganp = "static/img/Simbo/ANP.png";
                    if($(this).is(':checked')){
                        map.addLayer(wmsLayerANP);
                        $('#imagen').append('<img src="'+imganp+'" class="imganp"/>');
                    } else {
                        map.removeLayer(wmsLayerANP);
                        $('img').remove('.imganp');
                    }
                });
                
                //Imagen GOES Actual
                var wmsSourceGOES = new ol.source.TileWMS({
                    visible: true,
                    url: 'http://132.247.103.145:8080/geoserver/LANOT/wms',
                    params: {'LAYERS': 'LANOT:S2_MSI_TC_20210531T160901','TILED': true},
                    serverType: 'geoserver',
                    });

                var wmsLayerGOES = new  ol.layer.Tile({
                    source: wmsSourceGOES,
                });
                imggeocolor = "static/img/Simbo/geocolorsim.png";
                $('#goes').click(function(){
                    heightsimbo(); //Se encuentra en el script slideimg.js y ajusta la altura de la caja de simbología
                    if($(this).is(':checked')){
                        map.addLayer(wmsLayerGOES)
                        $('#imagen').append('<img src="'+imggeocolor+'" class="imgeocolor"/>');
                    } else {
                        map.removeLayer(wmsLayerGOES)
                        $('img').remove('.imgeocolor');
                    }
                });

                //MB Satelital
                var wmsSourcesatel = new ol.source.TileImage({
                    visible: true,
                    url: 'https://mt1.google.com/vt/lyrs=y&x={x}&y={y}&z={z}'
                    });

                var wmsLayersatel = new  ol.layer.Tile({
                    source: wmsSourcesatel,
                    type: 'base',
                    visible: true,
                    zIndex: 0
                });

                $('#satelital').click(function(){
                    map.addLayer(wmsLayersatel)
                    $(this).css('border-color','#ffffff')
                    map.removeLayer(wmsLayerOSM)
                    map.removeLayer(wmsLayerdark)
                });
                

                //MB OSM
                var wmsSourceOSM = new ol.source.TileImage({
                    visible: true,
                    url: 'https://a.tile.openstreetmap.org/{z}/{x}/{y}.png'
                    });

                var wmsLayerOSM = new  ol.layer.Tile({
                    source: wmsSourceOSM,
                    type: 'base',
                    visible: true,
                    zIndex: 0
                });

                $('#osm').click(function(){
                    map.addLayer(wmsLayerOSM)
                    $(this).css('border-color','#ffffff')
                    map.removeLayer(wmsLayersatel)
                    map.removeLayer(wmsLayerdark)
                });

                //MB oscuro
                var wmsSourcedark = new ol.source.TileImage({
                    visible: true,
                    url: 'http://a.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png'
                    });

                var wmsLayerdark = new  ol.layer.Tile({
                    source: wmsSourcedark,
                    type: 'base',
                    visible: true,
                    zIndex: 0
                });

                $('#oscuro').click(function(){
                    map.addLayer(wmsLayerdark)
                    $(this).css('border-color','#ffffff')
                    map.removeLayer(wmsLayersatel)
                    map.removeLayer(wmsLayerOSM)
                });

                //Geocoder
                const geocoder = new Geocoder('nominatim', {
                provider: 'osm',
                targetType: 'text-input',
                lang: 'en',
                placeholder: 'Busca un lugar...',
                limit: 5,
                keepOpen: false,
                });

                geocoder.on('addresschosen', function(evt){
                var feature = evt.feature,
                    coord = evt.coordinate,
                    address = evt.address;
                // some popup solution
                content.innerHTML = '<p>'+ address.formatted +'</p>';
                overlay.setPosition(coord);
                });

                map.addControl(geocoder);

				//Agregamos objetos al mapa	
                map.addControl(scaleline);//Agregamos barra de esacala
                //map.addControl(ol.control.defaults({attribution: false}).extend([mousePositionControl]));
                //map.addInteraction(select);//Agregamos interacción con el select
                //map.addOverlay(popup)//Agregamos variable popup

                
			
        </script>
    </section>
    </body>
</html>




